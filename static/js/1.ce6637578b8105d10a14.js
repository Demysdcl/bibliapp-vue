webpackJsonp([1,4],{49:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.createPagination=function(t,e){var o={};return o.total=t.length,o.per_page=10,o.currentPage=e,o.total_pages=Math.ceil(o.total/o.per_page),o},e.createPage=function(t,e,o){var i=o*e.per_page,n=i-e.per_page;return i>t.length&&(i=t.length),t.slice(n,i)}},158:function(t,e,o){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=o(5),a=i(n),s=o(10);e.default={name:"CcBooksForm",data:function(){return{book:{id:null,authorId:"",title:""}}},mounted:function(){this.fetch(),this.fetchAuthors()},watch:{$route:"fetch"},computed:(0,a.default)({},(0,s.mapState)({authors:function(t){return t.Authors.full_list}}),{isEditing:function(){return this.book.id>0},isValid:function(){return this.resetMessages(),""!==this.book.title||(this.setMessage({type:"error",message:["Please fill book title"]}),!1)}}),methods:(0,a.default)({},(0,s.mapActions)(["authorsSetData","setFetching","resetMessages","setMessage"]),{fetch:function(){var t=this,e=this.$route.params.id;void 0!==e&&(this.setFetching({fetching:!0}),this.$http.get("books/"+e).then(function(e){var o=e.data.data,i=o.id,n=o.title,a=o.authorId;t.book.title=n,t.book.id=i,t.book.authorId=a,t.setFetching({fetching:!1})}))},fetchAuthors:function(){var t=this;this.authors.length||(this.setFetching({fetching:!0}),this.$http.get("authors").then(function(e){var o=e.data;o.forEach(function(t){t.fullName=t.firstName+" "+t.lastName}),t.authorsSetData({full_list:o}),t.setFetching({fetching:!1})}))},submit:function(){this.isValid&&(this.setFetching({fetching:!0}),this.isEditing?this.update():this.save())},save:function(){var t=this;this.$http.post("books",this.book).then(function(){t.$bus.$emit("book.created"),t.setFetching({fetching:!1}),t.setMessage({type:"success",message:"New book was created"}),t.reset()})},update:function(){var t=this;this.$http.put("books/"+this.book.id,this.book).then(function(){t.$bus.$emit("book.updated"),t.setFetching({fetching:!1}),t.setMessage({type:"success",message:"Book was updated"})})},reset:function(){this.book.id=0,this.book.authorId=0,this.book.name=""}})}},159:function(t,e,o){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=o(5),a=i(n),s=o(10),r=o(49);e.default={name:"CcBooks",methods:(0,a.default)({edit:function(t){var e=this.books[t].id;this.$router.push({name:"books.edit",params:{id:e},query:{page:this.currentPage}})},create:function(){this.$router.push({name:"books.new",query:{page:this.currentPage}})},hide:function(){this.$router.push({name:"books.index",query:{page:this.currentPage}})}},(0,s.mapActions)(["booksSetData","setFetching"]),{fetch:function(){var t=this;this.setFetching({fetching:!0}),this.$http.get("books").then(function(e){var o=e.data;o.forEach(function(e){t.$http.get("authors/"+e.authorId).then(function(t){e.author=t.data})}),t.booksSetData({list:o,pagination:(0,r.createPagination)(o,t.currentPage)}),t.setFetching({fetching:!1})})},navigate:function(t){this.$router.push({name:"books.index",query:{page:t}})},askRemove:function(t){var e=this,o=this.books[t];swal({title:"Are you sure?",text:"Book "+o.title+" will be permanently removed.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, do it!",closeOnConfirm:!1},function(){return e.remove(o)})},remove:function(t){var e=this;this.$http.delete("books/"+t.id).then(function(){e.fetch(),swal("Done!","Book removed.","success"),e.isFormVisible&&e.$router.push({name:"books.index",query:{page:e.currentPage}})}).catch(function(t){swal("Falha!",t.response.data.messages[0],"error")})}}),watch:{currentPage:"fetch"},computed:(0,a.default)({},(0,s.mapState)({fetching:function(t){return t.fetching},pagination:function(t){return t.Books.pagination},list:function(t){return t.Books.list}}),{books:function(){return this.list},currentPage:function(){return parseInt(this.$route.query.page,10)||1},isFormVisible:function(){return"books.new"===this.$route.name||"books.edit"===this.$route.name}}),beforeRouteLeave:function(t,e,o){this.$bus.$off("book.created"),this.$bus.$off("book.updated"),jQuery("body").off("keyup"),o()},mounted:function(){var t=this;this.$bus.$on("book.created",function(){return t.fetch()}),this.$bus.$on("book.updated",function(){return t.fetch()}),this.fetch()}}},244:function(t,e,o){e=t.exports=o(40)(),e.push([t.id,".pagination[data-v-59db989d]{float:right;margin-top:20px}.button-within-header[data-v-59db989d]{margin-top:32px}.fade-enter-active[data-v-59db989d],.fade-leave-active[data-v-59db989d]{transition:opacity .7s ease}.fade-enter[data-v-59db989d],.fade-leave-active[data-v-59db989d]{opacity:0}","",{version:3,sources:["/./src/app/books/main.vue"],names:[],mappings:"AACA,6BACE,YAAa,AACb,eAAiB,CAClB,AACD,uCACE,eAAiB,CAClB,AACD,wEACE,2BAA6B,CAC9B,AACD,iEACE,SAAW,CACZ",file:"main.vue",sourcesContent:["\n.pagination[data-v-59db989d] {\n  float: right;\n  margin-top: 20px;\n}\n.button-within-header[data-v-59db989d] {\n  margin-top: 32px;\n}\n.fade-enter-active[data-v-59db989d], .fade-leave-active[data-v-59db989d] {\n  transition: opacity .7s ease;\n}\n.fade-enter[data-v-59db989d], .fade-leave-active[data-v-59db989d] {\n  opacity: 0;\n}\n"],sourceRoot:"webpack://"}])},269:function(t,e,o){var i=o(244);"string"==typeof i&&(i=[[t.id,i,""]]);o(44)(i,{});i.locals&&(t.exports=i.locals)},286:function(t,e,o){var i,n;i=o(158);var a=o(302);n=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(n=i=i.default),"function"==typeof n&&(n=n.options),n.render=a.render,n.staticRenderFns=a.staticRenderFns,t.exports=i},287:function(t,e,o){var i,n;o(269),i=o(159);var a=o(297);n=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(n=i=i.default),"function"==typeof n&&(n=n.options),n.render=a.render,n.staticRenderFns=a.staticRenderFns,n._scopeId="data-v-59db989d",t.exports=i},297:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"row"},[t._m(0),t._v(" "),o("div",{staticClass:"col-md-6 text-right"},[o("div",{staticClass:"button-within-header"},[o("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.isFormVisible,expression:"!isFormVisible"}],attrs:{type:"default",icon:"plus",size:"mini"},on:{click:t.create}}),t._v(" "),o("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isFormVisible,expression:"isFormVisible"}],attrs:{type:"default",icon:"minus",size:"mini"},on:{click:t.hide}})],1)])]),t._v(" "),o("transition",{attrs:{name:"fade"}},[o("router-view")],1),t._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:t.fetching,expression:"fetching",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:t.books,stripe:"",border:""}},[o("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),t._v(" "),o("el-table-column",{attrs:{prop:"title",label:"Book"}}),t._v(" "),o("el-table-column",{attrs:{prop:"author.firstName",label:"Author"}}),t._v(" "),o("el-table-column",{attrs:{label:"Options",width:"100"},inlineTemplate:{render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-button",{attrs:{type:"default",icon:"edit",size:"mini"},on:{click:function(e){t.edit(t.scope.$index)}}}),t._v(" "),o("el-button",{attrs:{type:"default",icon:"delete",size:"mini"},on:{click:function(e){t.askRemove(t.scope.$index)}}})],1)},staticRenderFns:[]}})],1),t._v(" "),o("div",{staticClass:"pagination"},[o("el-pagination",{attrs:{"current-page":t.pagination.current_page,"page-size":t.pagination.per_page,layout:"total, prev, pager, next, jumper",total:t.pagination.total},on:{"current-change":t.navigate}})],1)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"col-md-6"},[o("h1",[t._v("Book Management")])])}]}},302:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"well"},[o("el-form",{ref:"form",attrs:{model:t.book,"label-width":"120px"}},[o("el-form-item",{attrs:{label:"Book title"}},[o("el-input",{model:{value:t.book.title,callback:function(e){t.$set(t.book,"title",e)},expression:"book.title"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"Author"}},[o("el-select",{attrs:{placeholder:"Select Author",filterable:""},model:{value:t.book.authorId,callback:function(e){t.$set(t.book,"authorId",e)},expression:"book.authorId"}},t._l(t.authors,function(t){return o("el-option",{attrs:{label:t.fullName,value:t.id}})})),t._v(" "),o("el-button",{on:{click:t.submit}},[t._v("Save")])],1)],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=1.ce6637578b8105d10a14.js.map